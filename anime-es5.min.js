/*
 (c) 2016 Julian Garnier
 Released under the MIT license
*/
'use strict';var _this=this;
(function(l,m){"function"===typeof define&&define.amd?define([],m):"object"===typeof module&&module.exports?module.exports=m():l.anime=m()})(this,function(){function l(a,b){if(a.includes)return a.includes(b);f.array(a)||(a=[].slice.call(a));return a.length?a.some(T(b)):!1}function m(a,b,c){var d=!1;f.func(c)&&(d=!0);1==b&&a.anims.forEach(function(a){d?c(a):a[c]()});var e=function(k){return function(){a.anims[k]&&(d?c(a.anims[k]):a.anims[k][c](),a.anims[k].once(b,e(0==k?1:k+1)));return a}};return e(0)()}
var U="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skewX skewY".split(" "),D={duration:1E3,delay:0,loop:!1,autoplay:!0,direction:"normal",easing:"easeOutElastic",reversed:!1,elasticity:400,round:!1},f={array:Array.isArray,object:function(a){return l(Object.prototype.toString.call(a),"Object")},html:function(a){return a instanceof NodeList||a instanceof HTMLCollection},node:function(a){return a.nodeType},bool:function(a){return"boolean"===typeof a},svg:function(a){return a instanceof
SVGElement},dom:function(a){return f.node(a)||f.svg(a)},number:function(a){return!isNaN(parseInt(a))},string:function(a){return"string"===typeof a},func:function(a){return"function"===typeof a},undef:function(a){return"undefined"===typeof a},null:function(a){return"null"===typeof a},hex:function(a){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)},rgb:function(a){return/^rgb/.test(a)},rgba:function(a){return/^rgba/.test(a)},hsl:function(a){return/^hsl/.test(a)},color:function(a){return f.hex(a)||
f.rgb(a)||f.rgba(a)||f.hsl(a)}},E=function(a,b){var c=a.length,d=function(){for(var e=arguments.length,k=Array(e),w=0;w<e;w++)k[w]=arguments[w];return k.length<c?function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return d.apply(null,k.concat(b))}:a.apply(b||_this,k)};return d},T=E(function(a,b){return a===b}),F=function(){var a={},b={Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a,b){if(0===a||1===a)return a;
b=1-Math.min(b,998)/1E3;a=a/1-1;return-(Math.pow(2,10*a)*Math.sin(2*(a-b/(2*Math.PI)*Math.asin(1))*Math.PI/b))},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}};["Quad","Cubic","Quart","Quint","Expo"].forEach(function(a,c){b[a]=function(a){return Math.pow(a,c+2)}});var c=function(c){var d=b[c];a["easeIn"+c]=d;a["easeOut"+c]=function(a,b){return 1-d(1-a,b)};a["easeInOut"+c]=function(a,b){return.5>
a?d(2*a,b)/2:1-d(-2*a+2,b)/2}},d;for(d in b)c(d);a.linear=function(a){return a};return a}(),x=function(a){return f.string(a)?a:""+a},G=function(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},H=function(a){if(f.color(a))return!1;try{return document.querySelectorAll(a)}catch(b){return!1}},y=function(a){if(f.array(a))return a;f.string(a)&&(a=H(a)||a);return f.html(a)?[].slice.call(a):[a]},r=function(a){return Array.prototype.reduce.call(a,function(a,c){return a.concat(f.array(c)?r(c):
c)},[])},V=function(a,b){var c={};a.forEach(function(a){var e=JSON.stringify(b.map(function(b){return a[b]}));c[e]=c[e]||[];c[e].push(a)});return Object.keys(c).map(function(a){return c[a]})},z=function(a){return a.filter(function(a,c,d){return d.indexOf(a)===c})},v=function(a,b){for(var c in b)a[c]=f.undef(a[c])?b[c]:a[c];return a},I=function(a){function b(a,b){b.type=a;b.handle={on:function(){e.add(b);return b.handle},once:function(){return d(a,b)},off:function(){c(b);return b.handle}};e.add(b);
return b.handle}function c(a){e.has(a)&&e.delete(a);return a.handle}function d(d,e){if(f.func(e)){var g=function(){var f=function(){e.apply(a,arguments);c(f)};c(e);return{v:b(d,f)}}();if("object"===typeof g)return g.v}}f.object(a)||(a={});var e=new Set;a.listeners=e;a.on=b;a.once=function(a,b){return f.func(b)?d(a,b):new Promise(function(b){d(a,b)})};return a},t=function(a,b){var c=arguments;"begin"==a&&(b.started=!0);0<b.listeners.size&&function(){var d=[].slice.call(c,1);b.listeners.forEach(function(c){c.type==
a&&c.apply(b,d.concat(c.handle))})}()},W=function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,f){return b+b+c+c+f+f});var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);a=parseInt(b[1],16);var c=parseInt(b[2],16),b=parseInt(b[3],16);return"rgb("+a+","+c+","+b+")"},A=function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a},n=function(a){return/([\+\-]?[0-9|auto\.]+)(%|px|pt|em|rem|in|cm|mm|ex|pc|vw|vh|deg)?/.exec(a)[2]},J=function(a,
b,c){return n(b)?b:l(a,"translate")?n(c)?b+n(c):b+"px":l(a,"rotate")||l(a,"skew")?b+"deg":b},K=function(a,b){if(f.dom(a)&&l(U,b))return"transform";if(f.dom(a)&&"transform"!==b&&B(a,b))return"css";if(f.dom(a)&&(a.getAttribute(b)||f.svg(a)&&a[b]))return"attribute";if(!f.null(a[b])&&!f.undef(a[b]))return"object"},B=function(a,b){if(b in a.style)return getComputedStyle(a).getPropertyValue(G(b))||"0"},X=function(a,b){var c=l(b,"scale")?1:0;a=a.style.transform;if(!a)return c;for(var d=/(\w+)\((.+?)\)/g,
e=[],k=[],f=[];e=d.exec(a);)k.push(e[1]),f.push(e[2]);a=f.filter(function(a,c){return k[c]===b});return a.length?a[0]:c},L=function(a,b){var c=K(a,b);return"transform"===c?X(a,b):"css"===c?B(a,b):"attribute"===c?a.getAttribute(b):a[b]||0},M=function(a,b,c){if(f.color(b)){if(!f.rgb(b)&&!f.rgba(b))if(f.hex(b))b=W(b);else if(f.hsl(b)){a=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(b);b=parseInt(a[1])/360;c=parseInt(a[2])/100;a=parseInt(a[3])/100;if(0===c)c=a=b=a;else{var d=.5>a?a*(1+c):a+c-a*c,e=2*
a-d;c=A(e,d,b+1/3);a=A(e,d,b);b=A(e,d,b-1/3)}b="rgb("+255*c+","+255*a+","+255*b+")"}else b=void 0;return b}if(n(b))return b;a=n(a.to)?n(a.to):n(a.from);!a&&c&&(a=n(c));return a?b+a:b},N=function(a){var b=/-?\d*\.?\d+/g;return{original:a,numbers:x(a).match(b)?x(a).match(b).map(Number):[0],strings:x(a).split(b)}},Y=function(a,b,c){return b.reduce(function(b,e,f){return b+a[f-1]+(e?e:c[f-1])})},O=function(a){return a?r(f.array(a)?a.map(y):y(a)):[]},Z=function(a){return O(a).map(function(a,c){return{target:a,
id:c}})},P=function(a,b,c,d){"transform"===c?(c=a+("("+J(a,b.from,b.to)+")"),b=a+("("+J(a,b.to)+")")):(a="css"===c?B(d,a):void 0,c=M(b,b.from,a),b=M(b,b.to,a));return{from:N(c),to:N(b)}},aa=function(a,b){var c=[];a.forEach(function(d,e){var k=d.target;return b.forEach(function(b){var l=K(k,b.name);if(l){var q;q=b.name;var h=b.value,h=y(f.func(h)?h(k,e):h);q={from:1<h.length?h[0]:L(k,q),to:1<h.length?h[1]:h[0]};h=Object.create(b);h.animatables=d;h.type=l;h.from=P(b.name,q,h.type,k).from;h.to=P(b.name,
q,h.type,k).to;h.round=f.color(q.from)||h.round?1:0;h.delay=(f.func(h.delay)?h.delay(k,e,a.length):h.delay)/g.speed;h.duration=(f.func(h.duration)?h.duration(k,e,a.length):h.duration)/g.speed;c.push(h)}})});return c},ba=function(a,b){a=aa(a,b);return V(a,["name","from","to","delay","duration"]).map(function(a){var b=Object.create(a[0]);b.animatables=a.map(function(a){return a.animatables});b.totalDuration=b.delay+b.duration;return b})},C=function(a,b){a.tweens.forEach(function(c){var d=c.from,e=a.duration-
(c.delay+c.duration);c.from=c.to;c.to=d;b&&(c.delay=e)});a.reversed=!!a.reversed},ca=function(a){if(a.length)return Math.max.apply(Math,a.map(function(a){return a.totalDuration}))},Q=function(a){var b=[],c=[];a.tweens.forEach(function(a){if("css"===a.type||"transform"===a.type)b.push("css"===a.type?G(a.name):"transform"),a.animatables.forEach(function(a){return c.push(a.target)})});return{properties:z(b).join(", "),elements:z(c)}},da=function(a){var b=Q(a);b.elements.forEach(function(a){return a.style.willChange=
b.properties})},ea=function(a){Q(a).elements.forEach(function(a){return a.style.removeProperty("will-change")})},fa=function(a,b){var c=a.path,d=a.value*b,e=function(e){return c.getPointAtLength(1<b?a.value+(e||0):d+(e||0))},f=e(),g=e(-1),e=e(1),l=a.name;return"translateX"===l?f.x:"translateY"===l?f.y:"rotate"===l?180*Math.atan2(e.y-g.y,e.x-g.x)/Math.PI:void 0},ga=function(a,b){var c=Math.min(Math.max(b-a.delay,0),a.duration)/a.duration;b=a.to.numbers.map(function(b,e){e=a.from.numbers[e];var f=F[a.easing](c,
a.elasticity);b=a.path?fa(a,f):e+f*(b-e);return a.round?Math.round(b*a.round)/a.round:b});return Y(b,a.to.strings,a.from.strings)},R=function(a,b){var c={};a.currentTime=b;a.progress=Math.min(Math.max(b,0),a.duration)/a.duration*100;a.tweens.forEach(function(b){b.currentValue=ga(b,a.currentTime);var d=b.currentValue;b.animatables.forEach(function(a){var f=a.id,g=b.name;a=a.target;switch(b.type){case "css":a.style[g]=d;break;case "attribute":a.setAttribute(g,d);break;case "object":a[g]=d;break;case "transform":c||
(c={}),c[f]||(c[f]=[]),c[f].push(d)}})});if(c)for(var d in c)a.animatables[d].target.style.transform=c[d].join(" ");t("update",a)},S=function(a){var b={animatables:Z(a.targets),settings:v(a,D),currentTime:0,progress:0,started:!1,ended:!1},c=b.settings,d=[],e;for(e in a)if(!D.hasOwnProperty(e)&&"targets"!==e){var k=f.object(a[e])?Object.create(a[e]):{value:a[e]};k.name=e;d.push(v(k,c))}b.properties=d;b.tweens=ba(b.animatables,b.properties);b.duration=ca(b.tweens)||a.duration;return I(b)},u=new Set,
p={raf:0,play:function(){p.raf=requestAnimationFrame(p.step)},step:function(a){u.size?(u.forEach(function(b){return b.tick(a)}),p.play()):(cancelAnimationFrame(p.raf),p.raf=0)}},ha=["complete","begin","update"],g=function(a,b){var c={},d=S(a);b&&(d.settings.autoplay=!1);ha.forEach(function(a){if(f.func(d.settings[a]))d[l(a,"update","interloop")?"on":"once"](a,d.settings[a]);Object.defineProperty(d,a,{get:function(){return d.once(a)},set:function(b){if(f.func(b))d[l(a,"update","interloop")?"on":"once"](a,
b)}})});d.tick=function(a){d.ended=!1;c.start||(c.start=a);c.current=Math.min(Math.max(c.last+a-c.start,0),d.duration);var b=d.settings;R(d,c.current);c.current>=d.duration&&(b.loop?(c.start=a,"alternate"===b.direction&&C(d,!0),f.number(b.loop)&&b.loop--,t("interloop",d)):(d.ended=!0,d.pause(!0),t("complete",d)),t("begin",d),c.last=0)};d.seek=function(a){return R(d,a/100*d.duration)};d.pause=function(a){a||t("pause",d);c.start=0;ea(d);u.delete(d);return d};d.play=function(a){a&&(d=v(S(v(a,d.settings)),
d));c.start=0;c.last=d.ended?0:d.currentTime;a=d.settings;"reverse"===a.direction&&C(d);"alternate"!==a.direction||a.loop||(a.loop=1);da(d);u.add(d);0==p.raf&&p.play();return d};d.restart=function(){d.reversed&&C(d);t("restart",d);d.pause(!0);d.seek(0);return d.play()};d.settings.autoplay&&d.play();return d};g.all=function(a){return Promise.all(r(arguments).slice(1).map(function(b){return b.once(a)}))};g.chain=function(){var a={anims:r(arguments),paused:!1,play:function(){a.paused&&(a.paused=!1);
return m(a,a.paused||"complete","play")},pause:function(){return m(a,a.paused=!0,"pause")},restart:function(){return m(a,"complete","restart")},add:function(){a.anims=a.anims.concat(r(arguments));a.anims.forEach(function(a){a.pause(!0);a.seek(0)});return a},remove:function(b){l(a.anims,b)&&(a.anims=a.anims.filter(function(a){return!Object.is(b,a)}));a.anims.forEach(function(a){a.pause(!0);a.seek(0)});return a},Do:function(b,c){return m(a.anims,b,c,a)}};return a};g.remove=function(a){a=O(a);u.forEach(function(b){b.tweens.forEach(function(c,
d){for(var e=c.animatables.length-1;0<=e;e--)l(a,c.animatables[e].target)&&(c.animatables.splice(e,1),c.animatables.length||b.tweens.splice(d,1),b.tweens.length||b.pause(!0))})})};g.speed=1;g.list=u;g.easings=F;g.getValue=L;g.path=function(a){a=f.string(a)?H(a)[0]:a;return{path:a,value:a.getTotalLength()}};g.random=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};g.curry=E;g.includes=l;g.mergeObjs=v;g.flattenArr=r;g.dropArrDupes=z;g.eventsys=I;g.version="1.2.0";return g});
